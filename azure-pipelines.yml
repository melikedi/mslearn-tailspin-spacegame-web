trigger:
  - main # or master if your repo uses master

pool:
  vmImage: "windows-2022"

steps:
  - task: UseDotNet@2
    displayName: "Use .NET SDK"
    inputs:
      version: "6.x"

  - script: dotnet restore
    displayName: "Restore dependencies"

  - script: dotnet build --configuration Release --no-restore
    displayName: "Build"

  - script: dotnet test --configuration Release --no-build
    displayName: "Run tests"

  - script: dotnet publish --configuration Release --no-build --output $(Build.ArtifactStagingDirectory)
    displayName: "Publish"

  - task: PublishBuildArtifacts@1
    displayName: "Publish artifact"
    inputs:
      PathtoPublish: "$(Build.ArtifactStagingDirectory)"
      ArtifactName: "drop"
